ВВЕДЕНИЕ

В данном репозитории хранится моя попытка создания API на nodejs и express для выдачи Пары Access/Refresh Tokens и MongoDB, для хранения рефреш токена.
Данный код был написан по методике TDD(test driven development), что значит что перед началом написания рабочего кода или рабочей части кода, создавался заранее тест который проверяет возращает ли вызов функции или HTTP запрос ожидаемые данные.
Следовательно, помимо основного рабочего кода, можно увидеть тесты и mock-сервера для проверки работоспособности кода.

КАК ПОЛЬЗОВАТЬСЯ:

Создайте файл '.env' и добавьте туда переменные SECRET=<Любой набор символов> и MONGO_URI = <Адрес монгоБД сервера>. После этого тесты и скрипт должны заработать.

Чтобы запустить тесты введите npm test.

Чтобы запустить mock-server запустите node ./tests/mockMongoDB.js

Чтобы запустить приложение в работу введите node index.js

МЕТОДЫ ШИФРОВАНИЯ:

Для создания Access Token была использована библиотека jsonwebtoken, алгоритм шифрования HS512

Для создания Refresh Token была использовалась случайно сгенерированная строка совмещённая с 5-ю символами из Access Token, так же RT переводится в формат base64, прежде чем передаться в ответ, а после шифруется по bcrypt алгоритму(библиотека bcryptjs) и сохраняется в базу данных 

Для определения принадлежности Refresh Token к какому-либо Access Token и используется Хеш таблица хранящаяся в памяти сервера, которая сохраняет в себе в Access Token-ы, а ключём к ним является переведнная в обратно ASCII часть Refresh токена. При обращении к /refreshtokens заявленная удаляется и записывается новая запись в Хеш-таблицу, затем создаётся новый Refresh token и модернезируется запись в таблице
